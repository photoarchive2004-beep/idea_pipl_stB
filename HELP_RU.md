# HELP — что делает каждая стадия (A–G)

Ниже — смысл стадий простыми словами, входы/выходы и как запускать.

## Общие правила (важно)

### 1) Каждая идея — это отдельная папка
Формат: `ideas\IDEA-YYYYMMDD-###\`
Внутри:
- `idea.txt` — ваш сырой текст
- `in\` — сюда кладутся ответы ChatGPT (JSON)
- `out\` — сюда пишутся результаты стадий
- `logs\` — логи модуля внутри идеи

### 2) ExitCode=2 — это «ожидание ChatGPT», а не ошибка
Если стадия завершилась с `ExitCode=2`, она:
- подготовила PROMPT
- скопировала его в буфер
- открыла целевой JSON-файл в Блокноте

Дальше вы:
1) вставляете PROMPT в ChatGPT
2) копируете **ТОЛЬКО JSON** из ответа
3) вставляете в открытый файл `ideas\IDEA-...\in\*.json`, сохраняете
4) запускаете ту же стадию ещё раз

### 3) Логи
- `launcher_logs\LAST_LOG.txt` — путь к последнему логу запуска (удобно для диагностики)
- `launcher_logs\runX_*.log` — подробный лог каждого запуска (X = A/B/C/...)
- `ideas\IDEA-...\logs\module*.log` — лог модуля внутри конкретной идеи

---

## Stage A — Intake + строгая структура гипотез
**Цель:** превратить сырой текст в «нормальную научную постановку»: проблема, H1 + альтернативы, предсказания, решающие тесты.

**Вход:**
- `ideas\IDEA-...\idea.txt`

**Выход (в `out\`):**
- `structured_idea.json` — структурированная идея
- `tests.md` — список решающих тестов
- (вспомогательное) `llm_prompt_A.txt` — PROMPT для ChatGPT

**Как запускать:**
- `RUN_A.bat` (без аргументов — берёт самую новую идею)
- `RUN_A.bat "ideas\IDEA-..."` (конкретная папка)

**LLM:** да (встроено, 2 запуска)

---

## Stage B — Literature Scout (OpenAlex) + PRISMA-lite
**Цель:** быстро собрать «скопинг-корпус» литературы: не идеально, но достаточно, чтобы построить карту поля и дальше делать evidence.

**Перед запуском:**
- откройте `config\secrets.env` и вставьте ваш `OPENALEX_API_KEY`

**Вход:**
- `out\structured_idea.json` (из Stage A)

**Выход (в `out\`):**
- `corpus.csv` — список работ (минимальный корпус)
- `search_log.json` — как искали (прозрачность)
- `field_map.md` — грубая карта поля
- `prisma_lite.md` — PRISMA-lite отчёт

**Как запускать:**
- `RUN_B.bat` (по умолчанию BALANCED)
- `RUN_B.bat "ideas\IDEA-..."`

**Режимы:**
- BALANCED — рекомендовано (широко, но без дикого шума)
- WIDE — максимально широко (больше стыков, но больше мусора)
- FOCUSED — строго по теме (меньше мусора, но можно пропустить «прорывы на стыке»)

---

## Stage C — Evidence Table Engine (C1/C2/C3)
**Цель:** из корпуса Stage B собрать кандидаты «claim ↔ source» и составить evidence-таблицу.

**Вход:**
- `out\structured_idea.json` (A)
- `out\corpus.csv` (B)

**Выход (в `out\`):**
- `evidence_table.csv` — нормализованная таблица доказательств
- `evidence_table.md` — человекочитаемая таблица по claim_id
- `evidence_summary.md` — агрегаты + QC
- `evidence_bundle.json` — стабильный экспорт для Stage D
- `module_C3.log`, `_moduleC3_checkpoint.json`
**Как запускать:**
- `RUN_C3.bat` (новый launcher)
- `RUN_C.bat` (совместимость: проксирует в C3)
- `RUN_C3.bat "ideas\IDEA-..."`

**UX с ChatGPT (2 запуска):**
1) Первый запуск создаёт `in\c3_chatgpt\PROMPT.txt` и `README_WHAT_TO_DO.txt`, возвращает ExitCode=2.
2) Вставьте JSON ответ в `in\c3_chatgpt\RESPONSE.json`.
3) Повторный запуск автоматически продолжает и строит итоговые файлы.

---

## Stage D — Gap Map & Contradiction Finder
**Цель:** найти пробелы, противоречия и «что неизвестно решающим образом» по evidence-таблице.

**Вход:**
- `out\evidence_table.csv` (C)

**Выход (в `out\`):**
- `gap_map.md`
- `gap_map.json`

**Как запускать:**
- `RUN_D.bat` (новейшая идея)
- `RUN_D.bat "ideas\IDEA-..."`
- `RUN_D.bat -All` (для всех идей)

---

## Stage E — Новизна/прорывность + мосты в смежные области
**Цель:** оценить novelty/breakthrough сигналы и предложить «мосты» в соседние дисциплины.

**Вход (best effort):**
- `out\corpus.csv` (B) — основной
- опционально: `out\structured_idea.json` (A), `out\gap_map.json` (D)

**Выход (в `out\`):**
- `novelty_breakthrough.json`
- `bridge_ideas.md`

**Запуск:**
- `RUN_E.bat` (будет вопрос: ChatGPT-assisted или автономно)
- `RUN_E.bat -All`

---

## Stage F — Двойная оценка (Publishability vs Breakthrough)
**Цель:** две независимые оценки + позиция идеи в матрице риск/выигрыш.

**Вход (best effort):**
- A/B/C/D/E результаты (если чего-то нет — стадия не падает, просто пишет «не хватает данных»)

**Выход (в `out\`):**
- `scores.json`
- `report.md`
- `portfolio_position.md`

**Запуск:**
- `RUN_F.bat` (выбор режима: ChatGPT-assisted или автономно)
- `RUN_F.bat -All`

---

## Stage G — Генерация улучшенных вариантов идеи (grounded)
**Цель:** предложить «лучшие версии» идеи, которые:
- сильнее по решающим тестам
- лучше «приземлены» к вашему корпусу/доказательствам
- потенциально лучше по publishability / breakthrough

**Вход (best effort):**
- всё, что есть из A–F (не обязателен полный набор)

**Выход (в `out\`):**
- `better_ideas.md`
- `better_ideas.json`

**Запуск:**
- `RUN_G.bat` (режим: ChatGPT-assisted или автономно)
- `RUN_G.bat -All`

---

## Что можно спокойно удалять

- `launcher_logs\` — это только логи запусков (конвейер их создаст снова)
- `runtime\` — кеши/портативный Python uv (если хотите «с нуля»)
- `.venv\` — виртуальное окружение (если хотите переустановить зависимости)

Внутри конкретной идеи можно удалять `out\` и `logs\`, если хотите заново прогнать стадии (но лучше сначала сохранить результаты).
